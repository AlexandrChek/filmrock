"use strict";(self["webpackChunkfilmrock"]=self["webpackChunkfilmrock"]||[]).push([[691],{2973:function(e,t,i){i.d(t,{Z:function(){return o}});var n=i(3396);function r(e,t,i,r,s,l){return(0,n.wg)(),(0,n.iD)("p",null,[(0,n.WI)(e.$slots,"default",{},void 0,!0)])}var s={name:"AdaptiveParagraf"},l=i(89);const a=(0,l.Z)(s,[["render",r],["__scopeId","data-v-159b1725"]]);var o=a},8647:function(e,t,i){i.d(t,{Z:function(){return p}});var n=i(3396),r=i(7139);const s={class:"row d-flex justify-content-center my-3"},l={class:"col-xl-3 col-lg-4 col-sm-4 col-5 text-center img-wrapper"},a=["src","alt"],o={class:"col-xl-8 col-lg-7 col-sm-8 col-7 px-xl-4"};function c(e,t,i,c,u,d){const g=(0,n.up)("FilmTitle"),h=(0,n.up)("AdaptiveParagraf");return(0,n.wg)(),(0,n.iD)("div",s,[(0,n._)("div",l,[(0,n._)("img",{src:i.film.src,alt:i.film.title,class:"img-fluid"},null,8,a)]),(0,n._)("div",o,[(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,r.zw)(i.film.title),1)])),_:1}),(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Year:  "+(0,r.zw)(i.film.year),1)])),_:1}),(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Genres:  "+(0,r.zw)(i.film.genre)+", "+(0,r.zw)(i.film.genre2),1)])),_:1}),(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Country:  "+(0,r.zw)(i.film.country),1)])),_:1}),(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Director:  "+(0,r.zw)(i.film.director),1)])),_:1}),(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Actors:  "+(0,r.zw)(i.film.actors)+" and others... ",1)])),_:1}),(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Lasting:  "+(0,r.zw)(i.film.lasting),1)])),_:1}),(0,n.Wm)(h,{class:"m-0 ratings"},{default:(0,n.w5)((()=>[(0,n.Uk)(" Rating:  "+(0,r.zw)(u.rating),1)])),_:1}),(0,n.Wm)(h,{class:"ratings"},{default:(0,n.w5)((()=>[(0,n.Uk)(" Number of ratings:  "+(0,r.zw)(i.film.numberOfRatings||0),1)])),_:1}),(0,n.WI)(e.$slots,"default",{},void 0,!0)])])}function u(e,t,i,r,s,l){return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.WI)(e.$slots,"default",{},void 0,!0)])}var d={name:"FilmTitle"},g=i(89);const h=(0,g.Z)(d,[["render",u],["__scopeId","data-v-41af438c"]]);var v=h,w=i(2973),m={name:"SmallCard",props:["film"],components:{FilmTitle:v,AdaptiveParagraf:w.Z},data(){return{rating:0}},mounted(){const e=setInterval((()=>{this.film.rating&&(this.rating=this.film.rating.toFixed(1),clearInterval(e))}),10)}};const f=(0,g.Z)(m,[["render",c],["__scopeId","data-v-3b81956b"]]);var p=f},3691:function(e,t,i){i.r(t),i.d(t,{default:function(){return we}});var n=i(3396),r=i(7139);const s=e=>((0,n.dD)("data-v-63f813f1"),e=e(),(0,n.Cn)(),e),l={class:"container-fluid"},a={class:"row d-flex justify-content-center"},o=s((()=>(0,n._)("b",null,"Description:",-1))),c={class:"row d-flex justify-content-center my-3"},u={class:"col-lg-11 col-12"},d={class:"row d-flex justify-content-center mb-2"},g={class:"col-lg-11 col-12"},h={class:"row d-flex justify-content-center"},v={class:"col-lg-11 col-12 mb-4"};function w(e,t,i,s,w,m){const f=(0,n.up)("MyButton"),p=(0,n.up)("AdaptiveParagraf"),k=(0,n.up)("SmallCard"),R=(0,n.up)("ModalRegWarning"),_=(0,n.up)("ModalRate"),b=(0,n.up)("VideoBlock"),y=(0,n.up)("LineHeader"),M=(0,n.up)("MovieLine"),C=(0,n.up)("ReviewForm"),W=(0,n.up)("ReviewsList");return(0,n.wg)(),(0,n.iD)("div",l,[(0,n.Wm)(k,{film:w.currentFilm},{default:(0,n.w5)((()=>[w.notRated?((0,n.wg)(),(0,n.j4)(f,{key:0,onClick:m.rateFilm},{default:(0,n.w5)((()=>[(0,n.Uk)(" Rate the film ")])),_:1},8,["onClick"])):((0,n.wg)(),(0,n.j4)(p,{key:1,class:"rated"},{default:(0,n.w5)((()=>[(0,n.Uk)(" You have rated this film. Thank you! ")])),_:1}))])),_:1},8,["film"]),w.regWarning?((0,n.wg)(),(0,n.j4)(R,{key:0,onClosewarning:m.closeRegWarning},{default:(0,n.w5)((()=>[(0,n.Uk)(" To rate films you have to log into your account ore register. ")])),_:1},8,["onClosewarning"])):(0,n.kq)("",!0),w.showModalRate?((0,n.wg)(),(0,n.j4)(_,{key:1,onRatingReceived:m.setRating,onRatingClosed:m.closeModalRate},null,8,["onRatingReceived","onRatingClosed"])):(0,n.kq)("",!0),(0,n._)("div",a,[(0,n.Wm)(p,{class:"col-lg-11 col-12"},{default:(0,n.w5)((()=>[o,(0,n.Uk)("  "+(0,r.zw)(w.currentFilm.description),1)])),_:1})]),(0,n._)("div",c,[(0,n._)("div",u,[(0,n.Wm)(b,{trailerUrl:w.currentFilm.trailer,filmUrl:w.currentFilm.url,altUrl:w.currentFilm.url_alt},null,8,["trailerUrl","filmUrl","altUrl"])])]),(0,n._)("div",d,[(0,n._)("div",g,[(0,n.Wm)(y,{left:!0},{default:(0,n.w5)((()=>[(0,n.Uk)("This might interest you:")])),_:1}),(0,n.Wm)(M,{list:w.suitableMovies,shortListLength:w.shortListLength},null,8,["list","shortListLength"])])]),(0,n._)("div",h,[(0,n._)("div",v,[(0,n.Wm)(y,{left:!0,class:"mb-1"},{default:(0,n.w5)((()=>[(0,n.Uk)("Reviews")])),_:1}),(0,n.Wm)(C,{onReviewSent:m.updateReviews},null,8,["onReviewSent"]),w.reviewsLength?((0,n.wg)(),(0,n.j4)(W,{key:0,reviewsLength:w.reviewsLength,allReviews:w.allReviews},null,8,["reviewsLength","allReviews"])):(0,n.kq)("",!0)])])])}i(7658);var m=i(8647);const f={key:1},p={key:1},k=["href"];function R(e,t,i,s,l,a){const o=(0,n.up)("ColoredBtns"),c=(0,n.up)("VideoFrame");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(o,{onMovieClicked:a.onMovie,onTrailerClicked:a.onTrailer},null,8,["onMovieClicked","onTrailerClicked"]),(0,n._)("div",{class:(0,r.C_)(["p-1",{"back-orange":l.orangeBack,"back-burgundy":!l.orangeBack}])},[l.orangeBack?((0,n.wg)(),(0,n.j4)(c,{key:0,url:i.trailerUrl},null,8,["url"])):((0,n.wg)(),(0,n.iD)("div",f,[i.filmUrl?((0,n.wg)(),(0,n.j4)(c,{key:0,url:i.filmUrl},null,8,["url"])):((0,n.wg)(),(0,n.iD)("p",p,[(0,n.Uk)(" There is no such film on YouTube. We suggest using an "),(0,n._)("a",{href:i.altUrl,target:"_blank"},"alternative source",8,k)]))]))],2)],64)}const _={class:"d-inline-flex"};function b(e,t,i,r,s,l){return(0,n.wg)(),(0,n.iD)("div",_,[(0,n._)("div",{class:"trailer-button",onClick:t[0]||(t[0]=(...e)=>l.onTrailer&&l.onTrailer(...e))},"Trailer"),(0,n._)("div",{class:"movie-button",onClick:t[1]||(t[1]=(...e)=>l.onMovie&&l.onMovie(...e))},"Movie")])}var y={name:"ColoredBtns",methods:{onMovie(){this.$emit("movieClicked")},onTrailer(){this.$emit("trailerClicked")}}},M=i(89);const C=(0,M.Z)(y,[["render",b],["__scopeId","data-v-567d896b"]]);var W=C;const U={class:"ratio ratio-16x9"},F=["src"];function L(e,t,i,r,s,l){return(0,n.wg)(),(0,n.iD)("div",U,[(0,n._)("iframe",{src:i.url,allowfullscreen:""},null,8,F)])}var B={name:"VideoFrame",props:["url"]};const I=(0,M.Z)(B,[["render",L]]);var j=I,S={name:"VideoBlock",components:{ColoredBtns:W,VideoFrame:j},props:["trailerUrl","filmUrl","altUrl"],data(){return{orangeBack:!0}},methods:{onMovie(){this.orangeBack=!1,this.url=this.filmUrl},onTrailer(){this.orangeBack=!0,this.url=this.trailerUrl}}};const $=(0,M.Z)(S,[["render",R],["__scopeId","data-v-41a5930c"]]);var Z=$,D=i(453),T=i(2973);const x={class:"modal-warning rounded"},z={class:"d-flex justify-content-around"};function H(e,t,i,r,s,l){return(0,n.wg)(),(0,n.iD)("div",x,[(0,n._)("p",null,[(0,n.WI)(e.$slots,"default",{},void 0,!0)]),(0,n._)("div",z,[(0,n._)("button",{class:"btn btn-danger",onClick:t[0]||(t[0]=(...e)=>l.logIn&&l.logIn(...e))},"Log in"),(0,n._)("button",{class:"btn btn-danger",onClick:t[1]||(t[1]=(...e)=>l.register&&l.register(...e))},"Register"),(0,n._)("button",{class:"btn btn-danger",onClick:t[2]||(t[2]=(...e)=>l.close&&l.close(...e))},"Cancel")])])}var A={name:"ModalRegWarning",methods:{logIn(){this.$router.push("/logIn")},register(){this.$router.push("/registration")},close(){this.$emit("closewarning")}}};const V=(0,M.Z)(A,[["render",H],["__scopeId","data-v-385e1452"]]);var Y=V,q=i(9242);const P=e=>((0,n.dD)("data-v-250f01ed"),e=e(),(0,n.Cn)(),e),N={class:"modal-rating rounded"},O=P((()=>(0,n._)("p",null,"Rate the film (from 0 to 10):",-1))),G={class:"rate-wrapper"},E={class:"rating-value"},K={class:"d-flex justify-content-around"};function J(e,t,i,s,l,a){return(0,n.wg)(),(0,n.iD)("div",N,[O,(0,n._)("div",G,[(0,n.Uk)(" 0 "),(0,n.wy)((0,n._)("input",{type:"range",min:"0",max:"10",step:"0.5","onUpdate:modelValue":t[0]||(t[0]=e=>l.rating=e)},null,512),[[q.nr,l.rating]]),(0,n.Uk)(" 10 ")]),(0,n._)("div",E,(0,r.zw)(l.rating),1),(0,n._)("div",K,[(0,n._)("button",{class:"btn btn-success",onClick:t[1]||(t[1]=(...e)=>a.sendRating&&a.sendRating(...e))},"Rate"),(0,n._)("button",{class:"btn btn-danger",onClick:t[2]||(t[2]=(...e)=>a.close&&a.close(...e))},"Cancel")])])}var Q={name:"ModalRate",data(){return{rating:0}},methods:{sendRating(){this.$emit("ratingReceived",this.rating)},close(){this.$emit("ratingClosed")}}};const X=(0,M.Z)(Q,[["render",J],["__scopeId","data-v-250f01ed"]]);var ee=X,te=i(5645),ie=i(2117);const ne=["placeholder"];function re(e,t,i,r,s,l){const a=(0,n.up)("MyButton"),o=(0,n.up)("ModalRegWarning");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("form",null,[(0,n.wy)((0,n._)("textarea",{placeholder:s.proposition,class:"mb-2","onUpdate:modelValue":t[0]||(t[0]=e=>s.review=e),onFocus:t[1]||(t[1]=(...e)=>l.checkReg&&l.checkReg(...e))},null,40,ne),[[q.nr,s.review]]),(0,n.Wm)(a,{class:"send-btn",onClick:(0,q.iM)(l.send,["prevent"])},{default:(0,n.w5)((()=>[(0,n.Uk)("Send")])),_:1},8,["onClick"])]),s.regWarning?((0,n.wg)(),(0,n.j4)(o,{key:0,onClosewarning:l.closeRegWarning},{default:(0,n.w5)((()=>[(0,n.Uk)(" To make comments you have to log into your account or to register. ")])),_:1},8,["onClosewarning"])):(0,n.kq)("",!0)],64)}var se=i(1178),le={name:"ReviewForm",components:{MyButton:D.Z,ModalRegWarning:Y},data(){return{proposition:"Enter your review here",review:"",regWarning:!1}},emits:["reviewSent"],methods:{send(){if(this.$store.state.user){const e=(0,se.N8)(),t=this.$route.params.id,i=this.$store.state.user,n=this.review,r=new Date,s=String(r.getFullYear());let l={month:String(r.getMonth()+1),day:String(r.getDate()),hours:String(r.getHours()),minutes:String(r.getMinutes()),seconds:String(r.getSeconds())};for(let v in l)""===l[v]&&(l[v]="00"),1===l[v].length&&(l[v]="0"+l[v]);const a=l.month,o=l.day,c=l.hours,u=l.minutes,d=l.seconds;let g=Number(s+a+o+c+u+d),h=s+"-"+a+"-"+o+"_"+c+":"+u+":"+d;(0,se.t8)((0,se.iH)(e,"films/"+t+"/reviews/"+g),{revId:g,user:i,date:h,body:n}),this.review="",this.$emit("reviewSent")}else this.regWarning=!0},checkReg(){this.$store.state.user||(this.regWarning=!0,document.querySelector("textarea").blur())},closeRegWarning(){this.regWarning=!1}}};const ae=(0,M.Z)(le,[["render",re],["__scopeId","data-v-346db5c7"]]);var oe=ae;function ce(e,t,i,s,l,a){const o=(0,n.up)("AdaptiveParagraf"),c=(0,n.up)("MyButton");return(0,n.wg)(),(0,n.iD)(n.HY,null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.reviews,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e,class:"mt-3"},[(0,n.Wm)(o,{class:"m-0 review-head"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,r.zw)(e.user)+",  "+(0,r.zw)(e.date),1)])),_:2},1024),(0,n.Wm)(o,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,r.zw)(e.body),1)])),_:2},1024)])))),128)),l.allReviewsBtn?((0,n.wg)(),(0,n.j4)(c,{key:0,onClick:a.showAllReviews},{default:(0,n.w5)((()=>[(0,n.Uk)(" Show all reviews ")])),_:1},8,["onClick"])):(0,n.kq)("",!0),l.collapseRewiewsBtn?((0,n.wg)(),(0,n.j4)(c,{key:1,onClick:a.collapseRewiews},{default:(0,n.w5)((()=>[(0,n.Uk)(" Collapse rewiews ")])),_:1},8,["onClick"])):(0,n.kq)("",!0)],64)}var ue={name:"ReviewsList",props:["reviewsLength","allReviews"],components:{AdaptiveParagraf:T.Z,MyButton:D.Z},data(){return{reviews:[],allReviewsBtn:!1,collapseRewiewsBtn:!1}},mounted(){const e=setInterval((()=>{this.getReviews(),this.allReviews.length===this.reviewsLength&&clearInterval(e)}),10)},methods:{getReviews(){this.reviewsLength<=15?this.reviews=[...this.allReviews]:(this.reviews=this.allReviews.slice(0,15),this.allReviewsBtn=!0)},showAllReviews(){this.reviews=[...this.allReviews],this.allReviewsBtn=!1,this.collapseRewiewsBtn=!0},collapseRewiews(){this.reviews=this.allReviews.slice(0,15),this.collapseRewiewsBtn=!1,this.allReviewsBtn=!0}}};const de=(0,M.Z)(ue,[["render",ce],["__scopeId","data-v-ab739934"]]);var ge=de,he={name:"FilmCard",components:{SmallCard:m.Z,VideoBlock:Z,MyButton:D.Z,AdaptiveParagraf:T.Z,ModalRegWarning:Y,ModalRate:ee,LineHeader:te.Z,MovieLine:ie.Z,ReviewForm:oe,ReviewsList:ge},data(){return{currentFilm:{},regWarning:!1,showModalRate:!1,notRated:!0,shortListLength:0,suitableMovies:[],id:this.$route.params.id,allReviews:[],reviewsLength:0}},mounted(){const e=(0,se.N8)(),t=(0,se.iH)(e,"films/"+this.id);(0,se.jM)(t,(e=>{this.currentFilm=e.val()})),this.$store.state.user&&this.findIsFilmRated(e);const i=(0,se.iH)(e,"films/");(0,se.jM)(i,(e=>{let t=e.val(),i=Object.values(t);while(this.suitableMovies.length<10)if(this.currentFilm.relatedTo){for(let e=0;e<i.length;e++)i[e].relatedTo===this.currentFilm.relatedTo&&i[e].id!=this.id&&this.suitableMovies.push(i[e]);this.getSuitablesByGenre(i)}else this.getSuitablesByGenre(i);if(this.currentFilm.reviews){let e=Object.values(this.currentFilm.reviews);this.allReviews=e.sort(((e,t)=>t.revId-e.revId)),this.reviewsLength=this.allReviews.length}})),this.getShortListLength(),window.onresize=()=>this.getShortListLength()},watch:{$route(){document.location.reload()}},methods:{findIsFilmRated(e){const t=this.$store.state.user,i=(0,se.iH)(e,"users/"+t);(0,se.jM)(i,(e=>{let t=e.val();if(t.ratings){let e=Object.keys(t.ratings);for(let t=0;t<e.length;t++)if(e[t]===this.id)return void(this.notRated=!1)}}))},getSuitablesByGenre(e){for(let t=0;t<e.length;t++)e[t].id!=this.id&&!this.suitableMovies.includes(e[t])&&(e[t].genre===this.currentFilm.genre&&e[t].genre2===this.currentFilm.genre2||e[t].genre===this.currentFilm.genre2&&e[t].genre2===this.currentFilm.genre)&&this.suitableMovies.push(e[t]);for(let t=0;t<e.length;t++)e[t].id==this.id||this.suitableMovies.includes(e[t])||e[t].genre!==this.currentFilm.genre&&e[t].genre2!==this.currentFilm.genre2&&e[t].genre!==this.currentFilm.genre2&&e[t].genre2!==this.currentFilm.genre||this.suitableMovies.push(e[t])},getShortListLength(){let e=window.innerWidth;this.shortListLength=e>=992?5:e<992&&e>=768?4:e<768&&e>=576?3:2},rateFilm(){this.$store.state.user?this.showModalRate=!0:this.regWarning=!0},closeRegWarning(){this.regWarning=!1},closeModalRate(){this.showModalRate=!1},setRating(e){const t=(0,se.N8)(),i=this.currentFilm.rating,n=this.currentFilm.numberOfRatings;let r=Number(e);const s=n+1,l=this.id,a=this.$store.state.user;n&&(r=(n*i+r)/s),(0,se.t8)((0,se.iH)(t,"films/"+l+"/rating"),r),(0,se.t8)((0,se.iH)(t,"films/"+l+"/numberOfRatings"),s),(0,se.t8)((0,se.iH)(t,"users/"+a+"/ratings/"+l),!0),this.showModalRate=!1,this.$router.push("/"+l)},updateReviews(){this.reviewsLength>1&&document.location.reload()}}};const ve=(0,M.Z)(he,[["render",w],["__scopeId","data-v-63f813f1"]]);var we=ve}}]);
//# sourceMappingURL=691.6a9e3bee.js.map
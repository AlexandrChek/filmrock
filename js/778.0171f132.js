"use strict";(self["webpackChunkfilmrock"]=self["webpackChunkfilmrock"]||[]).push([[778],{2973:function(e,t,i){i.d(t,{Z:function(){return o}});var n=i(3396);function r(e,t,i,r,l,s){return(0,n.wg)(),(0,n.iD)("p",null,[(0,n.WI)(e.$slots,"default",{},void 0,!0)])}var l={name:"AdaptiveParagraf"},s=i(89);const a=(0,s.Z)(l,[["render",r],["__scopeId","data-v-159b1725"]]);var o=a},8647:function(e,t,i){i.d(t,{Z:function(){return p}});var n=i(3396),r=i(7139);const l={class:"row d-flex justify-content-center my-3"},s={class:"col-xl-3 col-lg-4 col-sm-4 col-5 text-center img-wrapper"},a=["src","alt"],o={class:"col-xl-8 col-lg-7 col-sm-8 col-7 px-xl-4"};function c(e,t,i,c,u,d){const g=(0,n.up)("FilmTitle"),h=(0,n.up)("AdaptiveParagraf");return(0,n.wg)(),(0,n.iD)("div",l,[(0,n._)("div",s,[(0,n._)("img",{src:i.film.src,alt:i.film.title,class:"img-fluid"},null,8,a)]),(0,n._)("div",o,[(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,r.zw)(i.film.title),1)])),_:1}),(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Year:  "+(0,r.zw)(i.film.year),1)])),_:1}),(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Genres:  "+(0,r.zw)(i.film.genre)+", "+(0,r.zw)(i.film.genre2),1)])),_:1}),(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Country:  "+(0,r.zw)(i.film.country),1)])),_:1}),(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Director:  "+(0,r.zw)(i.film.director),1)])),_:1}),(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Actors:  "+(0,r.zw)(i.film.actors)+" and others... ",1)])),_:1}),(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Lasting:  "+(0,r.zw)(i.film.lasting),1)])),_:1}),(0,n.Wm)(h,{class:"m-0 ratings"},{default:(0,n.w5)((()=>[(0,n.Uk)(" Rating:  "+(0,r.zw)(u.rating),1)])),_:1}),(0,n.Wm)(h,{class:"ratings"},{default:(0,n.w5)((()=>[(0,n.Uk)(" Number of ratings:  "+(0,r.zw)(i.film.numberOfRatings||0),1)])),_:1}),(0,n.WI)(e.$slots,"default",{},void 0,!0)])])}function u(e,t,i,r,l,s){return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.WI)(e.$slots,"default",{},void 0,!0)])}var d={name:"FilmTitle"},g=i(89);const h=(0,g.Z)(d,[["render",u],["__scopeId","data-v-41af438c"]]);var v=h,w=i(2973),m={name:"SmallCard",props:["film"],components:{FilmTitle:v,AdaptiveParagraf:w.Z},data(){return{rating:0}},mounted(){const e=setInterval((()=>{this.film.rating&&(this.rating=this.film.rating.toFixed(1),clearInterval(e))}),10)}};const f=(0,g.Z)(m,[["render",c],["__scopeId","data-v-3b81956b"]]);var p=f},8778:function(e,t,i){i.r(t),i.d(t,{default:function(){return fe}});var n=i(3396),r=i(7139);const l=e=>((0,n.dD)("data-v-63f813f1"),e=e(),(0,n.Cn)(),e),s={class:"container-fluid"},a={class:"row d-flex justify-content-center"},o=l((()=>(0,n._)("b",null,"Description:",-1))),c={class:"row d-flex justify-content-center my-3"},u={class:"col-lg-11 col-12"},d={class:"row d-flex justify-content-center mb-2"},g={class:"col-lg-11 col-12"},h={class:"row d-flex justify-content-center"},v={class:"col-lg-11 col-12 mb-4"};function w(e,t,i,l,w,m){const f=(0,n.up)("MyButton"),p=(0,n.up)("AdaptiveParagraf"),k=(0,n.up)("SmallCard"),R=(0,n.up)("ModalRegWarning"),_=(0,n.up)("ModalRate"),b=(0,n.up)("VideoBlock"),y=(0,n.up)("LineHeader"),C=(0,n.up)("MovieLine"),M=(0,n.up)("ReviewForm"),W=(0,n.up)("ReviewsList");return(0,n.wg)(),(0,n.iD)("div",s,[(0,n.Wm)(k,{film:w.currentFilm},{default:(0,n.w5)((()=>[w.notRated?((0,n.wg)(),(0,n.j4)(f,{key:0,onClick:m.rateFilm},{default:(0,n.w5)((()=>[(0,n.Uk)(" Rate the film ")])),_:1},8,["onClick"])):((0,n.wg)(),(0,n.j4)(p,{key:1,class:"rated"},{default:(0,n.w5)((()=>[(0,n.Uk)(" You have rated this film. Thank you! ")])),_:1}))])),_:1},8,["film"]),w.regWarning?((0,n.wg)(),(0,n.j4)(R,{key:0,onClosewarning:m.closeRegWarning},{default:(0,n.w5)((()=>[(0,n.Uk)(" To rate films you have to log into your account ore register. ")])),_:1},8,["onClosewarning"])):(0,n.kq)("",!0),w.showModalRate?((0,n.wg)(),(0,n.j4)(_,{key:1,onRatingReceived:m.setRating,onRatingClosed:m.closeModalRate},null,8,["onRatingReceived","onRatingClosed"])):(0,n.kq)("",!0),(0,n._)("div",a,[(0,n.Wm)(p,{class:"col-lg-11 col-12"},{default:(0,n.w5)((()=>[o,(0,n.Uk)("  "+(0,r.zw)(w.currentFilm.description),1)])),_:1})]),(0,n._)("div",c,[(0,n._)("div",u,[(0,n.Wm)(b,{trailerUrl:w.currentFilm.trailer,filmUrl:w.currentFilm.url,altUrl:w.currentFilm.url_alt},null,8,["trailerUrl","filmUrl","altUrl"])])]),(0,n._)("div",d,[(0,n._)("div",g,[(0,n.Wm)(y,{left:!0},{default:(0,n.w5)((()=>[(0,n.Uk)("This might interest you:")])),_:1}),(0,n.Wm)(C,{list:w.suitableMovies,shortListLength:w.shortListLength},null,8,["list","shortListLength"])])]),(0,n._)("div",h,[(0,n._)("div",v,[(0,n.Wm)(y,{left:!0,class:"mb-1"},{default:(0,n.w5)((()=>[(0,n.Uk)("Reviews")])),_:1}),(0,n.Wm)(M,{onReviewSent:m.updateReviews},null,8,["onReviewSent"]),w.reviewsLength?((0,n.wg)(),(0,n.j4)(W,{key:0,reviewsLength:w.reviewsLength,allReviews:w.allReviews},null,8,["reviewsLength","allReviews"])):(0,n.kq)("",!0)])])])}i(7658);var m=i(8647);const f=e=>((0,n.dD)("data-v-0f700751"),e=e(),(0,n.Cn)(),e),p={key:1},k={key:1,class:"alt-url"},R=f((()=>(0,n._)("p",null,"There is no such film on YouTube.",-1))),_=["href"];function b(e,t,i,l,s,a){const o=(0,n.up)("ColoredBtns"),c=(0,n.up)("VideoFrame");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(o,{onMovieClicked:a.onMovie,onTrailerClicked:a.onTrailer},null,8,["onMovieClicked","onTrailerClicked"]),(0,n._)("div",{class:(0,r.C_)(["p-1",{"back-orange":s.orangeBack,"back-burgundy":!s.orangeBack}])},[s.orangeBack?((0,n.wg)(),(0,n.j4)(c,{key:0,url:i.trailerUrl},null,8,["url"])):((0,n.wg)(),(0,n.iD)("div",p,[i.filmUrl?((0,n.wg)(),(0,n.j4)(c,{key:0,url:i.filmUrl},null,8,["url"])):((0,n.wg)(),(0,n.iD)("div",k,[R,(0,n._)("p",null,[(0,n.Uk)("We suggest using an "),(0,n._)("a",{href:i.altUrl,target:"_blank"},"alternative source",8,_)])]))]))],2)],64)}const y={class:"d-inline-flex"};function C(e,t,i,r,l,s){return(0,n.wg)(),(0,n.iD)("div",y,[(0,n._)("div",{class:"trailer-button",onClick:t[0]||(t[0]=(...e)=>s.onTrailer&&s.onTrailer(...e))},"Trailer"),(0,n._)("div",{class:"movie-button",onClick:t[1]||(t[1]=(...e)=>s.onMovie&&s.onMovie(...e))},"Movie")])}var M={name:"ColoredBtns",methods:{onMovie(){this.$emit("movieClicked")},onTrailer(){this.$emit("trailerClicked")}}},W=i(89);const U=(0,W.Z)(M,[["render",C],["__scopeId","data-v-567d896b"]]);var F=U;const L={class:"ratio ratio-16x9"},B=["src"];function I(e,t,i,r,l,s){return(0,n.wg)(),(0,n.iD)("div",L,[(0,n._)("iframe",{src:i.url,allowfullscreen:""},null,8,B)])}var j={name:"VideoFrame",props:["url"]};const S=(0,W.Z)(j,[["render",I]]);var $=S,D={name:"VideoBlock",components:{ColoredBtns:F,VideoFrame:$},props:["trailerUrl","filmUrl","altUrl"],data(){return{orangeBack:!0}},methods:{onMovie(){this.orangeBack=!1,this.url=this.filmUrl},onTrailer(){this.orangeBack=!0,this.url=this.trailerUrl}}};const Z=(0,W.Z)(D,[["render",b],["__scopeId","data-v-0f700751"]]);var T=Z,x=i(453),z=i(2973);const H={class:"modal-warning rounded"},A={class:"d-flex justify-content-around"};function V(e,t,i,r,l,s){return(0,n.wg)(),(0,n.iD)("div",H,[(0,n._)("p",null,[(0,n.WI)(e.$slots,"default",{},void 0,!0)]),(0,n._)("div",A,[(0,n._)("button",{class:"btn btn-danger",onClick:t[0]||(t[0]=(...e)=>s.logIn&&s.logIn(...e))},"Log in"),(0,n._)("button",{class:"btn btn-danger",onClick:t[1]||(t[1]=(...e)=>s.register&&s.register(...e))},"Register"),(0,n._)("button",{class:"btn btn-danger",onClick:t[2]||(t[2]=(...e)=>s.close&&s.close(...e))},"Cancel")])])}var Y={name:"ModalRegWarning",methods:{logIn(){this.$router.push("/logIn")},register(){this.$router.push("/registration")},close(){this.$emit("closewarning")}}};const q=(0,W.Z)(Y,[["render",V],["__scopeId","data-v-385e1452"]]);var P=q,N=i(9242);const O=e=>((0,n.dD)("data-v-250f01ed"),e=e(),(0,n.Cn)(),e),G={class:"modal-rating rounded"},E=O((()=>(0,n._)("p",null,"Rate the film (from 0 to 10):",-1))),K={class:"rate-wrapper"},J={class:"rating-value"},Q={class:"d-flex justify-content-around"};function X(e,t,i,l,s,a){return(0,n.wg)(),(0,n.iD)("div",G,[E,(0,n._)("div",K,[(0,n.Uk)(" 0 "),(0,n.wy)((0,n._)("input",{type:"range",min:"0",max:"10",step:"0.5","onUpdate:modelValue":t[0]||(t[0]=e=>s.rating=e)},null,512),[[N.nr,s.rating]]),(0,n.Uk)(" 10 ")]),(0,n._)("div",J,(0,r.zw)(s.rating),1),(0,n._)("div",Q,[(0,n._)("button",{class:"btn btn-success",onClick:t[1]||(t[1]=(...e)=>a.sendRating&&a.sendRating(...e))},"Rate"),(0,n._)("button",{class:"btn btn-danger",onClick:t[2]||(t[2]=(...e)=>a.close&&a.close(...e))},"Cancel")])])}var ee={name:"ModalRate",data(){return{rating:0}},methods:{sendRating(){this.$emit("ratingReceived",this.rating)},close(){this.$emit("ratingClosed")}}};const te=(0,W.Z)(ee,[["render",X],["__scopeId","data-v-250f01ed"]]);var ie=te,ne=i(5645),re=i(2117);const le=["placeholder"];function se(e,t,i,r,l,s){const a=(0,n.up)("MyButton"),o=(0,n.up)("ModalRegWarning");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("form",null,[(0,n.wy)((0,n._)("textarea",{placeholder:l.proposition,class:"mb-2","onUpdate:modelValue":t[0]||(t[0]=e=>l.review=e),onFocus:t[1]||(t[1]=(...e)=>s.checkReg&&s.checkReg(...e))},null,40,le),[[N.nr,l.review]]),(0,n.Wm)(a,{class:"send-btn",onClick:(0,N.iM)(s.send,["prevent"])},{default:(0,n.w5)((()=>[(0,n.Uk)("Send")])),_:1},8,["onClick"])]),l.regWarning?((0,n.wg)(),(0,n.j4)(o,{key:0,onClosewarning:s.closeRegWarning},{default:(0,n.w5)((()=>[(0,n.Uk)(" To make comments you have to log into your account or to register. ")])),_:1},8,["onClosewarning"])):(0,n.kq)("",!0)],64)}var ae=i(1178),oe={name:"ReviewForm",components:{MyButton:x.Z,ModalRegWarning:P},data(){return{proposition:"Enter your review here",review:"",regWarning:!1}},emits:["reviewSent"],methods:{send(){if(this.$store.state.user){const e=(0,ae.N8)(),t=this.$route.params.id,i=this.$store.state.user,n=this.review,r=new Date,l=String(r.getFullYear());let s={month:String(r.getMonth()+1),day:String(r.getDate()),hours:String(r.getHours()),minutes:String(r.getMinutes()),seconds:String(r.getSeconds())};for(let v in s)""===s[v]&&(s[v]="00"),1===s[v].length&&(s[v]="0"+s[v]);const a=s.month,o=s.day,c=s.hours,u=s.minutes,d=s.seconds;let g=Number(l+a+o+c+u+d),h=l+"-"+a+"-"+o+"_"+c+":"+u+":"+d;(0,ae.t8)((0,ae.iH)(e,"films/"+t+"/reviews/"+g),{revId:g,user:i,date:h,body:n}),this.review="",this.$emit("reviewSent")}else this.regWarning=!0},checkReg(){this.$store.state.user||(this.regWarning=!0,document.querySelector("textarea").blur())},closeRegWarning(){this.regWarning=!1}}};const ce=(0,W.Z)(oe,[["render",se],["__scopeId","data-v-346db5c7"]]);var ue=ce;function de(e,t,i,l,s,a){const o=(0,n.up)("AdaptiveParagraf"),c=(0,n.up)("MyButton");return(0,n.wg)(),(0,n.iD)(n.HY,null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.reviews,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e,class:"mt-3"},[(0,n.Wm)(o,{class:"m-0 review-head"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,r.zw)(e.user)+",  "+(0,r.zw)(e.date),1)])),_:2},1024),(0,n.Wm)(o,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,r.zw)(e.body),1)])),_:2},1024)])))),128)),s.allReviewsBtn?((0,n.wg)(),(0,n.j4)(c,{key:0,onClick:a.showAllReviews},{default:(0,n.w5)((()=>[(0,n.Uk)(" Show all reviews ")])),_:1},8,["onClick"])):(0,n.kq)("",!0),s.collapseRewiewsBtn?((0,n.wg)(),(0,n.j4)(c,{key:1,onClick:a.collapseRewiews},{default:(0,n.w5)((()=>[(0,n.Uk)(" Collapse rewiews ")])),_:1},8,["onClick"])):(0,n.kq)("",!0)],64)}var ge={name:"ReviewsList",props:["reviewsLength","allReviews"],components:{AdaptiveParagraf:z.Z,MyButton:x.Z},data(){return{reviews:[],allReviewsBtn:!1,collapseRewiewsBtn:!1}},mounted(){const e=setInterval((()=>{this.getReviews(),this.allReviews.length===this.reviewsLength&&clearInterval(e)}),10)},methods:{getReviews(){this.reviewsLength<=15?this.reviews=[...this.allReviews]:(this.reviews=this.allReviews.slice(0,15),this.allReviewsBtn=!0)},showAllReviews(){this.reviews=[...this.allReviews],this.allReviewsBtn=!1,this.collapseRewiewsBtn=!0},collapseRewiews(){this.reviews=this.allReviews.slice(0,15),this.collapseRewiewsBtn=!1,this.allReviewsBtn=!0}}};const he=(0,W.Z)(ge,[["render",de],["__scopeId","data-v-ab739934"]]);var ve=he,we={name:"FilmCard",components:{SmallCard:m.Z,VideoBlock:T,MyButton:x.Z,AdaptiveParagraf:z.Z,ModalRegWarning:P,ModalRate:ie,LineHeader:ne.Z,MovieLine:re.Z,ReviewForm:ue,ReviewsList:ve},data(){return{currentFilm:{},regWarning:!1,showModalRate:!1,notRated:!0,shortListLength:0,suitableMovies:[],id:this.$route.params.id,allReviews:[],reviewsLength:0}},mounted(){const e=(0,ae.N8)(),t=(0,ae.iH)(e,"films/"+this.id);(0,ae.jM)(t,(e=>{this.currentFilm=e.val()})),this.$store.state.user&&this.findIsFilmRated(e);const i=(0,ae.iH)(e,"films/");(0,ae.jM)(i,(e=>{let t=e.val(),i=Object.values(t);while(this.suitableMovies.length<10)if(this.currentFilm.relatedTo){for(let e=0;e<i.length;e++)i[e].relatedTo===this.currentFilm.relatedTo&&i[e].id!=this.id&&this.suitableMovies.push(i[e]);this.getSuitablesByGenre(i)}else this.getSuitablesByGenre(i);if(this.currentFilm.reviews){let e=Object.values(this.currentFilm.reviews);this.allReviews=e.sort(((e,t)=>t.revId-e.revId)),this.reviewsLength=this.allReviews.length}})),this.getShortListLength(),window.onresize=()=>this.getShortListLength()},watch:{$route(){document.location.reload()}},methods:{findIsFilmRated(e){const t=this.$store.state.user,i=(0,ae.iH)(e,"users/"+t);(0,ae.jM)(i,(e=>{let t=e.val();if(t.ratings){let e=Object.keys(t.ratings);for(let t=0;t<e.length;t++)if(e[t]===this.id)return void(this.notRated=!1)}}))},getSuitablesByGenre(e){for(let t=0;t<e.length;t++)e[t].id!=this.id&&!this.suitableMovies.includes(e[t])&&(e[t].genre===this.currentFilm.genre&&e[t].genre2===this.currentFilm.genre2||e[t].genre===this.currentFilm.genre2&&e[t].genre2===this.currentFilm.genre)&&this.suitableMovies.push(e[t]);for(let t=0;t<e.length;t++)e[t].id==this.id||this.suitableMovies.includes(e[t])||e[t].genre!==this.currentFilm.genre&&e[t].genre2!==this.currentFilm.genre2&&e[t].genre!==this.currentFilm.genre2&&e[t].genre2!==this.currentFilm.genre||this.suitableMovies.push(e[t])},getShortListLength(){let e=window.innerWidth;this.shortListLength=e>=992?5:e<992&&e>=768?4:e<768&&e>=576?3:2},rateFilm(){this.$store.state.user?this.showModalRate=!0:this.regWarning=!0},closeRegWarning(){this.regWarning=!1},closeModalRate(){this.showModalRate=!1},setRating(e){const t=(0,ae.N8)(),i=this.currentFilm.rating,n=this.currentFilm.numberOfRatings;let r=Number(e);const l=n+1,s=this.id,a=this.$store.state.user;n&&(r=(n*i+r)/l),(0,ae.t8)((0,ae.iH)(t,"films/"+s+"/rating"),r),(0,ae.t8)((0,ae.iH)(t,"films/"+s+"/numberOfRatings"),l),(0,ae.t8)((0,ae.iH)(t,"users/"+a+"/ratings/"+s),!0),this.showModalRate=!1,this.$router.push("/"+s)},updateReviews(){this.reviewsLength>1&&document.location.reload()}}};const me=(0,W.Z)(we,[["render",w],["__scopeId","data-v-63f813f1"]]);var fe=me}}]);
//# sourceMappingURL=778.0171f132.js.map
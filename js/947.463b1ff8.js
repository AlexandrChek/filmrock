"use strict";(self["webpackChunkfilmrock"]=self["webpackChunkfilmrock"]||[]).push([[947],{2973:function(e,t,i){i.d(t,{Z:function(){return o}});var n=i(3396);function s(e,t,i,s,r,l){return(0,n.wg)(),(0,n.iD)("p",null,[(0,n.WI)(e.$slots,"default",{},void 0,!0)])}var r={name:"AdaptiveParagraf"},l=i(89);const a=(0,l.Z)(r,[["render",s],["__scopeId","data-v-159b1725"]]);var o=a},1597:function(e,t,i){i.d(t,{Z:function(){return p}});var n=i(3396),s=i(7139);const r={class:"row d-flex justify-content-center my-3"},l={class:"col-xl-3 col-lg-4 col-sm-4 col-5 text-center img-wrapper"},a=["src","alt"],o={class:"col-xl-8 col-lg-7 col-sm-8 col-7 px-xl-4"};function c(e,t,i,c,u,d){const g=(0,n.up)("FilmTitle"),h=(0,n.up)("AdaptiveParagraf");return(0,n.wg)(),(0,n.iD)("div",r,[(0,n._)("div",l,[(0,n._)("img",{src:i.film.src,alt:i.film.title,class:"img-fluid"},null,8,a)]),(0,n._)("div",o,[(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,s.zw)(i.film.title),1)])),_:1}),(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Year:  "+(0,s.zw)(i.film.year),1)])),_:1}),(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Genres:  "+(0,s.zw)(i.film.genre)+", "+(0,s.zw)(i.film.genre2),1)])),_:1}),(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Country:  "+(0,s.zw)(i.film.country),1)])),_:1}),(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Director:  "+(0,s.zw)(i.film.director),1)])),_:1}),(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Actors:  "+(0,s.zw)(i.film.actors)+" and others... ",1)])),_:1}),(0,n.Wm)(h,null,{default:(0,n.w5)((()=>[(0,n.Uk)(" Lasting:  "+(0,s.zw)(i.film.lasting),1)])),_:1}),(0,n.Wm)(h,{class:"m-0 ratings"},{default:(0,n.w5)((()=>[(0,n.Uk)(" Rating:  "+(0,s.zw)(i.film.rating||0),1)])),_:1}),(0,n.Wm)(h,{class:"ratings"},{default:(0,n.w5)((()=>[(0,n.Uk)(" Number of ratings:  "+(0,s.zw)(i.film.numberOfRatings||0),1)])),_:1}),(0,n.WI)(e.$slots,"default",{},void 0,!0)])])}function u(e,t,i,s,r,l){return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.WI)(e.$slots,"default",{},void 0,!0)])}var d={name:"FilmTitle"},g=i(89);const h=(0,g.Z)(d,[["render",u],["__scopeId","data-v-41af438c"]]);var v=h,w=i(2973),m={name:"SmallCard",props:["film"],components:{FilmTitle:v,AdaptiveParagraf:w.Z}};const f=(0,g.Z)(m,[["render",c],["__scopeId","data-v-53210491"]]);var p=f},2947:function(e,t,i){i.r(t),i.d(t,{default:function(){return oe}});var n=i(3396),s=i(7139);const r=e=>((0,n.dD)("data-v-6b83106a"),e=e(),(0,n.Cn)(),e),l={class:"container-fluid"},a={class:"row d-flex justify-content-center"},o=r((()=>(0,n._)("b",null,"Description:",-1))),c={class:"row d-flex justify-content-center my-3"},u={class:"row d-flex justify-content-center mb-2"},d={class:"col-lg-11 col-12"},g={class:"row d-flex justify-content-center"},h={class:"col-lg-11 col-12 mb-4"};function v(e,t,i,r,v,w){const m=(0,n.up)("MyButton"),f=(0,n.up)("AdaptiveParagraf"),p=(0,n.up)("SmallCard"),R=(0,n.up)("ModalRegWarning"),k=(0,n.up)("ModalRate"),_=(0,n.up)("VideoBlock"),b=(0,n.up)("LineHeader"),y=(0,n.up)("MovieLine"),M=(0,n.up)("ReviewForm"),W=(0,n.up)("ReviewsList");return(0,n.wg)(),(0,n.iD)("div",l,[(0,n.Wm)(p,{film:v.currentFilm},{default:(0,n.w5)((()=>[v.notRated?((0,n.wg)(),(0,n.j4)(m,{key:0,onClick:w.rateFilm},{default:(0,n.w5)((()=>[(0,n.Uk)(" Rate the film ")])),_:1},8,["onClick"])):((0,n.wg)(),(0,n.j4)(f,{key:1,class:"rated"},{default:(0,n.w5)((()=>[(0,n.Uk)(" You have rated this film. Thank you! ")])),_:1}))])),_:1},8,["film"]),v.regWarning?((0,n.wg)(),(0,n.j4)(R,{key:0,onClosewarning:w.closeRegWarning},{default:(0,n.w5)((()=>[(0,n.Uk)(" To rate films you have to log into your account ore register. ")])),_:1},8,["onClosewarning"])):(0,n.kq)("",!0),v.showModalRate?((0,n.wg)(),(0,n.j4)(k,{key:1,onRatingReceived:w.setRating,onRatingClosed:w.closeModalRate},null,8,["onRatingReceived","onRatingClosed"])):(0,n.kq)("",!0),(0,n._)("div",a,[(0,n.Wm)(f,{class:"col-lg-11 col-12"},{default:(0,n.w5)((()=>[o,(0,n.Uk)("  "+(0,s.zw)(v.currentFilm.description),1)])),_:1})]),(0,n._)("div",c,[(0,n.Wm)(_,{trailerUrl:v.currentFilm.trailer,filmUrl:v.currentFilm.url},null,8,["trailerUrl","filmUrl"])]),(0,n._)("div",u,[(0,n._)("div",d,[(0,n.Wm)(b,{left:!0},{default:(0,n.w5)((()=>[(0,n.Uk)("This might interest you:")])),_:1}),(0,n.Wm)(y,{list:v.suitableMovies,shortListLength:v.shortListLength},null,8,["list","shortListLength"])])]),(0,n._)("div",g,[(0,n._)("div",h,[(0,n.Wm)(b,{left:!0,class:"mb-1"},{default:(0,n.w5)((()=>[(0,n.Uk)("Reviews")])),_:1}),(0,n.Wm)(M,{onReviewSent:w.updateReviews},null,8,["onReviewSent"]),v.reviewsLength?((0,n.wg)(),(0,n.j4)(W,{key:0,reviewsLength:v.reviewsLength,allReviews:v.allReviews},null,8,["reviewsLength","allReviews"])):(0,n.kq)("",!0)])])])}i(7658);var w=i(1597);const m={class:"col-lg-11 col-12"},f={class:"ratio ratio-16x9"},p=["src"];function R(e,t,i,r,l,a){const o=(0,n.up)("ColoredBtns");return(0,n.wg)(),(0,n.iD)("div",m,[(0,n.Wm)(o,{onClickMovie:a.onMovie,onClickTrailer:a.onTrailer},null,8,["onClickMovie","onClickTrailer"]),(0,n._)("div",{class:(0,s.C_)(["wrapper-static",{"wrapper-orange":l.orangeBack,"wrapper-burgundy":!l.orangeBack}])},[(0,n._)("div",f,[(0,n._)("iframe",{src:l.url,allowfullscreen:""},null,8,p)])],2)])}const k={class:"d-inline-flex"};function _(e,t,i,s,r,l){return(0,n.wg)(),(0,n.iD)("div",k,[(0,n._)("div",{class:"trailer-button",onClick:t[0]||(t[0]=(...e)=>l.onTrailer&&l.onTrailer(...e))},"Trailer"),(0,n._)("div",{class:"movie-button",onClick:t[1]||(t[1]=(...e)=>l.onMovie&&l.onMovie(...e))},"Movie")])}var b={name:"ColoredBtns",methods:{onMovie(){this.$emit("clickMovie")},onTrailer(){this.$emit("clickTrailer")}}},y=i(89);const M=(0,y.Z)(b,[["render",_],["__scopeId","data-v-56cd6e58"]]);var W=M,C={name:"VideoBlock",components:{ColoredBtns:W},props:["trailerUrl","filmUrl"],data(){return{orangeBack:!0,url:""}},mounted(){const e=setInterval((()=>{this.url=this.trailerUrl,this.url&&clearInterval(e)}),10)},methods:{onMovie(){this.orangeBack=!1,this.url=this.filmUrl},onTrailer(){this.orangeBack=!0,this.url=this.trailerUrl}}};const F=(0,y.Z)(C,[["render",R],["__scopeId","data-v-ba094e82"]]);var L=F,U=i(453),B=i(2973);const I={class:"modal-warning rounded"},S={class:"d-flex justify-content-around"};function $(e,t,i,s,r,l){return(0,n.wg)(),(0,n.iD)("div",I,[(0,n._)("p",null,[(0,n.WI)(e.$slots,"default",{},void 0,!0)]),(0,n._)("div",S,[(0,n._)("button",{class:"btn btn-danger",onClick:t[0]||(t[0]=(...e)=>l.logIn&&l.logIn(...e))},"Log in"),(0,n._)("button",{class:"btn btn-danger",onClick:t[1]||(t[1]=(...e)=>l.register&&l.register(...e))},"Register"),(0,n._)("button",{class:"btn btn-danger",onClick:t[2]||(t[2]=(...e)=>l.close&&l.close(...e))},"Cancel")])])}var Z={name:"ModalRegWarning",methods:{logIn(){this.$router.push("/logIn")},register(){this.$router.push("/registration")},close(){this.$emit("closewarning")}}};const j=(0,y.Z)(Z,[["render",$],["__scopeId","data-v-385e1452"]]);var T=j,x=i(9242);const D=e=>((0,n.dD)("data-v-250f01ed"),e=e(),(0,n.Cn)(),e),z={class:"modal-rating rounded"},H=D((()=>(0,n._)("p",null,"Rate the film (from 0 to 10):",-1))),A={class:"rate-wrapper"},q={class:"rating-value"},P={class:"d-flex justify-content-around"};function N(e,t,i,r,l,a){return(0,n.wg)(),(0,n.iD)("div",z,[H,(0,n._)("div",A,[(0,n.Uk)(" 0 "),(0,n.wy)((0,n._)("input",{type:"range",min:"0",max:"10",step:"0.5","onUpdate:modelValue":t[0]||(t[0]=e=>l.rating=e)},null,512),[[x.nr,l.rating]]),(0,n.Uk)(" 10 ")]),(0,n._)("div",q,(0,s.zw)(l.rating),1),(0,n._)("div",P,[(0,n._)("button",{class:"btn btn-success",onClick:t[1]||(t[1]=(...e)=>a.sendRating&&a.sendRating(...e))},"Rate"),(0,n._)("button",{class:"btn btn-danger",onClick:t[2]||(t[2]=(...e)=>a.close&&a.close(...e))},"Cancel")])])}var O={name:"ModalRate",data(){return{rating:0}},methods:{sendRating(){this.$emit("ratingReceived",this.rating)},close(){this.$emit("ratingClosed")}}};const Y=(0,y.Z)(O,[["render",N],["__scopeId","data-v-250f01ed"]]);var V=Y,G=i(5645),E=i(1556);const K=["placeholder"];function J(e,t,i,s,r,l){const a=(0,n.up)("MyButton"),o=(0,n.up)("ModalRegWarning");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("form",null,[(0,n.wy)((0,n._)("textarea",{placeholder:r.proposition,class:"mb-2","onUpdate:modelValue":t[0]||(t[0]=e=>r.review=e),onFocus:t[1]||(t[1]=(...e)=>l.checkReg&&l.checkReg(...e))},null,40,K),[[x.nr,r.review]]),(0,n.Wm)(a,{class:"send-btn",onClick:(0,x.iM)(l.send,["prevent"])},{default:(0,n.w5)((()=>[(0,n.Uk)("Send")])),_:1},8,["onClick"])]),r.regWarning?((0,n.wg)(),(0,n.j4)(o,{key:0,onClosewarning:l.closeRegWarning},{default:(0,n.w5)((()=>[(0,n.Uk)(" To make comments you have to log into your account or to register. ")])),_:1},8,["onClosewarning"])):(0,n.kq)("",!0)],64)}var Q=i(1178),X={name:"ReviewForm",components:{MyButton:U.Z,ModalRegWarning:T},data(){return{proposition:"Enter your review here",review:"",regWarning:!1}},emits:["reviewSent"],methods:{send(){if(this.$store.state.user){const e=(0,Q.N8)(),t=this.$route.params.id,i=this.$store.state.user,n=this.review,s=new Date,r=String(s.getFullYear());let l={month:String(s.getMonth()+1),day:String(s.getDate()),hours:String(s.getHours()),minutes:String(s.getMinutes()),seconds:String(s.getSeconds())};for(let v in l)""===l[v]&&(l[v]="00"),1===l[v].length&&(l[v]="0"+l[v]);const a=l.month,o=l.day,c=l.hours,u=l.minutes,d=l.seconds;let g=Number(r+a+o+c+u+d),h=r+"-"+a+"-"+o+"_"+c+":"+u+":"+d;(0,Q.t8)((0,Q.iH)(e,"films/"+t+"/reviews/"+g),{revId:g,user:i,date:h,body:n}),this.review="",this.$emit("reviewSent")}else this.regWarning=!0},checkReg(){this.$store.state.user||(this.regWarning=!0,document.querySelector("textarea").blur())},closeRegWarning(){this.regWarning=!1}}};const ee=(0,y.Z)(X,[["render",J],["__scopeId","data-v-346db5c7"]]);var te=ee;function ie(e,t,i,r,l,a){const o=(0,n.up)("AdaptiveParagraf"),c=(0,n.up)("MyButton");return(0,n.wg)(),(0,n.iD)(n.HY,null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.reviews,(e=>((0,n.wg)(),(0,n.iD)("div",{key:e,class:"mt-3"},[(0,n.Wm)(o,{class:"m-0 review-head"},{default:(0,n.w5)((()=>[(0,n.Uk)((0,s.zw)(e.user)+",  "+(0,s.zw)(e.date),1)])),_:2},1024),(0,n.Wm)(o,null,{default:(0,n.w5)((()=>[(0,n.Uk)((0,s.zw)(e.body),1)])),_:2},1024)])))),128)),l.allReviewsBtn?((0,n.wg)(),(0,n.j4)(c,{key:0,onClick:a.showAllReviews},{default:(0,n.w5)((()=>[(0,n.Uk)(" Show all reviews ")])),_:1},8,["onClick"])):(0,n.kq)("",!0),l.collapseRewiewsBtn?((0,n.wg)(),(0,n.j4)(c,{key:1,onClick:a.collapseRewiews},{default:(0,n.w5)((()=>[(0,n.Uk)(" Collapse rewiews ")])),_:1},8,["onClick"])):(0,n.kq)("",!0)],64)}var ne={name:"ReviewsList",props:["reviewsLength","allReviews"],components:{AdaptiveParagraf:B.Z,MyButton:U.Z},data(){return{reviews:[],allReviewsBtn:!1,collapseRewiewsBtn:!1}},mounted(){const e=setInterval((()=>{this.getReviews(),this.allReviews.length===this.reviewsLength&&clearInterval(e)}),10)},methods:{getReviews(){this.reviewsLength<=15?this.reviews=[...this.allReviews]:(this.reviews=this.allReviews.slice(0,15),this.allReviewsBtn=!0)},showAllReviews(){this.reviews=[...this.allReviews],this.allReviewsBtn=!1,this.collapseRewiewsBtn=!0},collapseRewiews(){this.reviews=this.allReviews.slice(0,15),this.collapseRewiewsBtn=!1,this.allReviewsBtn=!0}}};const se=(0,y.Z)(ne,[["render",ie],["__scopeId","data-v-ab739934"]]);var re=se,le={name:"FilmCard",components:{SmallCard:w.Z,VideoBlock:L,MyButton:U.Z,AdaptiveParagraf:B.Z,ModalRegWarning:T,ModalRate:V,LineHeader:G.Z,MovieLine:E.Z,ReviewForm:te,ReviewsList:re},data(){return{currentFilm:{},regWarning:!1,showModalRate:!1,notRated:!0,shortListLength:0,suitableMovies:[],id:this.$route.params.id,allReviews:[],reviewsLength:0}},mounted(){const e=(0,Q.N8)(),t=(0,Q.iH)(e,"films/");(0,Q.jM)(t,(e=>{let t=e.val(),i=Object.values(t);this.currentFilm=i.filter((e=>e.id==this.id))[0];while(this.suitableMovies.length<10)if(this.currentFilm.relatedTo){for(let e=0;e<i.length;e++)i[e].relatedTo===this.currentFilm.relatedTo&&i[e].id!==this.currentFilm.id&&this.suitableMovies.push(i[e]);this.getSuitablesByGenre(i)}else this.getSuitablesByGenre(i);if(this.currentFilm.reviews){let e=Object.values(this.currentFilm.reviews);this.allReviews=e.sort(((e,t)=>t.revId-e.revId)),this.reviewsLength=this.allReviews.length}})),this.$store.state.user&&this.findIsFilmRated(e),this.getShortListLength(),window.onresize=()=>this.getShortListLength()},watch:{$route(){document.location.reload()}},methods:{findIsFilmRated(e){const t=this.$store.state.user,i=(0,Q.iH)(e,"users/"+t);(0,Q.jM)(i,(e=>{let t=e.val();if(t.ratings){let e=Object.keys(t.ratings);for(let t=0;t<e.length;t++)if(e[t]===this.id)return void(this.notRated=!1)}}))},getSuitablesByGenre(e){for(let t=0;t<e.length;t++)e[t].id!=this.id&&!this.suitableMovies.includes(e[t])&&(e[t].genre===this.currentFilm.genre&&e[t].genre2===this.currentFilm.genre2||e[t].genre===this.currentFilm.genre2&&e[t].genre2===this.currentFilm.genre)&&this.suitableMovies.push(e[t]);for(let t=0;t<e.length;t++)e[t].id==this.id||this.suitableMovies.includes(e[t])||e[t].genre!==this.currentFilm.genre&&e[t].genre2!==this.currentFilm.genre2&&e[t].genre!==this.currentFilm.genre2&&e[t].genre2!==this.currentFilm.genre||this.suitableMovies.push(e[t])},getShortListLength(){let e=window.innerWidth;this.shortListLength=e>=992?5:e<992&&e>=768?4:e<768&&e>=576?3:2},rateFilm(){this.$store.state.user?this.showModalRate=!0:this.regWarning=!0},closeRegWarning(){this.regWarning=!1},closeModalRate(){this.showModalRate=!1},setRating(e){const t=(0,Q.N8)(),i=this.currentFilm.rating,n=this.currentFilm.numberOfRatings;let s=Number(e);const r=n+1,l=this.id,a=this.$store.state.user;n&&(s=((n*i+s)/r).toFixed(1)),(0,Q.t8)((0,Q.iH)(t,"films/"+l+"/rating"),s),(0,Q.t8)((0,Q.iH)(t,"films/"+l+"/numberOfRatings"),r),(0,Q.t8)((0,Q.iH)(t,"users/"+a+"/ratings/"+l),!0),this.showModalRate=!1,this.$router.push("/"+l)},updateReviews(){this.reviewsLength>1&&document.location.reload()}}};const ae=(0,y.Z)(le,[["render",v],["__scopeId","data-v-6b83106a"]]);var oe=ae}}]);
//# sourceMappingURL=947.463b1ff8.js.map